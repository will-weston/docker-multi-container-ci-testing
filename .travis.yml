sudo: required
services:
- docker
before_install:
- docker build -t $DOCKER_USER/multi-container-client:test -f ./multi-container-client/dev/Dockerfile
  ./multi-container-client
script:
- docker run $DOCKER_USER/multi-container-client:test npm run test -- --coverage
after_success:
- docker build -t $DOCKER_USER/multi-container-client:latest ./multi-container-client
- docker build -t $DOCKER_USER/multi-container-server:latest ./multi-container-server
- docker build -t $DOCKER_USER/multi-container-worker:latest ./multi-container-worker
- docker build -t $DOCKER_USER/multi-container-nginx:latest ./nginx
- echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USER" --password-stdin
- docker push $DOCKER_USER/multi-container-client:latest
- docker push $DOCKER_USER/multi-container-server:latest
- docker push $DOCKER_USER/multi-container-worker:latest
- docker push $DOCKER_USER/multi-container-nginx:latest
deploy:
  provider: elasticbeanstalk
  region: us-east-1
  app: will-multi-docker
  env: WillMultiDocker-env
  bucket_name: elasticbeanstalk-us-east-1-639769761355
  bucket_path: will-multi-docker
  on:
    branch: master
  access_key_id:
    secure: kUFDwjqRIYXrFJ6axcVdXawva16b05cNgJMnmQPgFV9Rur1eiDEzFY4HuDYhbBVM7aGTSU1nXZyQX3hFevQqLsMBFSBVsjyZO3kCh5E6TX/1jDQw9XaLHwkvog7cJLYedBAvDSrkOJaJ3/1FqD+BS51yGEKdtV+r4vB/YuuXTyDnG3KOXPHjB7Dk6JyGkpkXEeKiI3r/D5wCsplDawd/ByVdBvA6uTbRrQTcznRsk+3vhfLH2AAWybesuOhjiR76Q1XlKupb88D8AHBr9ac4LICdnaPHYtx1/NbjCRjTC8pGrzOB7lJMIemObPBf7wrNLNkMrDN1O86KCAgXsNtDIRJRkQyz2JJktqO1Ew07AubTPkZ3bBH5QxcOaI3oj2Rt64u3WlUvBL0cnIObm0LfnYp81SrTnFWf/a5lfGTKq4eZJB6x8EZT19xzcXqsehyKlSuCDlwDuUtQx+BcVoQ6MpuuIhVOptefYrwHHENhHo3ZpgtehwEIW48dY+tq9UVD4T5mltv1Jf1m78KdXoJg/SAYgPfrsXiIAG2kRQmzxFA+f5zQkHng0FjvagBjav6YuyR3JtmSgjSCm4xcZaRq0izVXM1c7mENAXR1nnIiF6m8hry0jOdts/HpglGqDNiTzKY0EFp2xUdNWbq3Bi8VNo8q35XrqYV1fYFtPmFv3cU=
  secret_access_key:
    secure: WCMlrjJPnUPRogN9iz2v6qoFzJVNxdwpSC6aUhd1shauBRqVZrohrnXy+YOCYMXPe4/KIkQWcmHyuHmUo2mTbf0mwvie6qHk5SObQ2PBoBlQYvXOB6J33kvoJ4uwZEnf1L6gDW3nlt4t1yXwZjYZ6Z7sPGqVVoYqKZOm4vWd2gDkopJ1AhLIbDopGoNYWZEja3NlJKMoiSySvUk/EwpwxDJKl1/UhU5wxlg3PZYEUqjz2nw5oCkBT143bRg6PSmjYHX2U2Vpam9pU8FgBi2QDntPOpVgye0rDlisalwxnAEaZ44Kd7DUgvMqZgs2x3sBm28LGkZFKJA8Spqa03p17I0L0Z/Gl2jbm16RJqsVd+eFYsJMSKlq1PUhrgCjzAuPw/WB4lmwy1CUD2XGT5R0lItRgkagRkhVOP40xXqZGC8x+BAv/CLDRVCYKqfnOXWMzOkWPi6Wj2JrNLoDoOY15xqyuygbsYmea/+RubSnEhyyGj1/sn91p0j69FWhIe/OvhoC8Wk9WioJIn4GlQhSWcvrJNGmK123MiL4trIO7V1Q57m42sprg96LEqvbDnY59PEMhZsBIC+ioOQtaENierawJQ0jZhxJrcNSiLqmhxNVJhy0WqjlR5Mh/ZgrGpqa0QqUdtsEqG9KD7WeTccJSYj18AxtSekxCkSqGMCJZ1I=
env:
  global:
  - secure: TyldJ6UH1QoCtoUQVYimIP2UiQDCgnQBX3X8QMkPJHpStTFGFnje3T8hulBYRqyKkzTkpP+ESwTqakY9fSdnR0my4csW3np9DY6vKM4QCMFvLvYTU4pSalyu++yXx6hFa0cSb8B8JTvLgXeKO8SYrhccjZOq5PlT9VmbmWngz7u9mXlfG4VxylusvhlDroavMA4ulJ1SNiI1Phou6HTk7eLUpc6XkO3zv1jyas8db4Kq0kD/fQZ+RtW92u/bgA5+tj1d6Z7e9RI6q41cnqiyzRcMafRaBPxhIOwZsgvQmA6i96o5g9NIgyw27QjTyroSQCJIzM9R3arKsnfiGhBQ8jX2kSU/cUTEq2T2yHKFSll+lELrAVBYL9OV2SkKbD4xkWWxqOwDlMUohGrTZsNm3LhghpH+Bnv7LblugPo0+93AsonNsmGilGJVgO6LJZyRLC5CKpezTJpxeh6+9/otSzt3sLaz6r5pas88PMQumX5piNFHJcYkoWCqofi3GXYWEI50KYk0S7YKPz3XcdQxd86cQj1GfdqnK7dxUJ/1UGSuDKnKlqdWj7rfyMeypA6cYoZJdRqRjxFbDSHCktaIp03gbd7kyMqFFEKmeeW9LYU+IudC8XgArSDWN3Mm4ZIIo6dOZ7BjndVz8Lr+zTN8wjrIrM1Z3kD2pqOA5x6LhSk=
  - secure: DrLkx0A3E7Gw9s/1L8onDcWltWHhbsFIn0f8LOLxxKzT7EDgJKr0i7dDy+NqHnZ6DteuERSa7wU6AUBaCal7SwmSUV2CDO3fD/hp3PgbQ1YrzbojBSnXw9E2OzwSbf8NuM2olxP2dveyT9ZkBcD8MYEG8RBUSxWv2G9ncYv5hFJv/N4nfNUGFbjlV/SVqWM86O1iW8VnN6nTMSsUKyv/g5vEE7lDhXLVscCQNSfqcAVl0/oHGqCxMVYiEcBh/brH0qLRsny9Ftj/lw5e1mCYHxtyZQRXGBsM/OlqiC79wM2oEGi3eYQ4oPOzKFZNPx83NLP8vqnx+2gTySVl8RsyqfiRbjY6x6am0QKHvcBKinZpzNFSLD/jG9FALNbuRTBkqrmECoFCsnSoCSCZqhySd1mQijdn4nn7XeVn1LCbiq+NnCdkSa79nArXpkKFbH1beIl6OR4bo8v80HGHvSmchN6LMB/Xo6cyAFwWD6mKM81o+kMC7/A4EsXgtfE6goufGJ9jGRK9FSjtMzhcxH1FwLp4Tl1QhR78nqfSHU8Scn5VqsRWMhe8HR4wpYjPfd6HaOTuEUHEfLhMYhJpHkRsQTAabj/DqZ8WuQdrq7yt2paDlTeLWq585GEOz1XzW6nlwVLCIVFoZSzDHlXlba35acIu7x6K7q8T/Ce138OprNE=
  - secure: JF6Wn2zScaBQgmB9Uuq3i8cKRtgPl3+Zp4huTn8g7MkaOQAhLitmhzNzLyo5Lnlwe1/r6YtXOWf9ExccjADWp5sQKlefIzFgONP8YFnc6s1fu5rQIwjZ6CG/rtf0gFcbSsjpNjpn9n5Jlp/ZmZ5o4wrA4RdOwt3Fe7QgKREm8YjFDItnMgm2WoB6oDNnwfB1XfiMRAdt76Der9PJlQMx0P75XX3A/FgTn1n0E1wBW5TWCO9ukRJDI838QDl1+tR/GZ+iCT6kdpXYNAbDHEGYenE4hgkVi0BSGry4NWlVA+IH8KyK2W/1s0ONHddAqIzbu6AyNorAOXwvwj2u6AbZ6QXFCKDedzr2X5iEaY/3RMsRPjTOs3MWutenGwAXmPae5ESpq9ruQiLorMAHIfo500UZQlLOnjvt43J/rowwOuNAvZLTZUi5T/gSffDc46Um8u0jhsv/VPEfI7Uu76a16Z1wwslAg3dCbNRCdfuHE9Kq1tQh28GyO1F3LklvvVY8cAG4L81Hbf4slR82GZhxdoAN41m3wSJCXqjyvZRegDLQhHI8av/JUvxLEDKXccDDLyuEna41YJxXLlvhUFpEOtKNg4CsIiQjFMlNvhb8b7vnymvD2LOLi0cyT2txdVOrTklKIAtA2bTYKz79gMqnYLLAhQpOwU6BZ2UD5Y5T5Cw=